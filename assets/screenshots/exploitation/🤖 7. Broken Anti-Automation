```markdown
# Broken Anti-Automation

**Category overview**  
Broken Anti-Automation refers to weaknesses that allow automated tools (bots, scripts, scanners) to interact with application functionality without effective detection or mitigation. Failures include missing or bypassable rate-limiting, absent or weak CAPTCHAs, predictable API endpoints, hidden features accessible without controls, and unprotected localization or admin endpoints. Exploitation enables mass enumeration, credential stuffing, brute force, content scraping, and automated abuse.

---

## Overview Observed in This Assessment

The assessment uncovered an anti-automation weakness in a controlled Juice Shop lab where a hidden localization resource (`tlh_AA`) was accessible and could be enumerated or leveraged by automated tooling. This indicates insufficient restriction of non-production assets and inadequate bot protections.

- **Extra Language** — an unused/hidden localization file (`tlh_AA`) was reachable and returned application strings not intended for general access.

Each finding below contains concise Steps to Reproduce, Impact, and Mitigations.

---

### A Extra Language (Hidden Localization Access)

**What it is**  
Non-production or hidden resources (localization files, feature flags, debug endpoints) that are accessible to unauthenticated or automated requests present an information disclosure and automation risk.

**Observed in lab**  
A localization endpoint returned the Klingon (`tlh_AA`) translation bundle. The file contained string keys and hints about internal features and challenge logic; it was accessible without any rate-limiting or authorization.

**Steps to Reproduce (concise)**  
1. Enumerate common localization paths (e.g., `/i18n/tlh_AA.json`, `/assets/i18n/tlh_AA`).  
2. Request the resource directly via browser or curl.  
3. Review returned JSON for internal strings, hidden routes, or challenge hints.

**Impact**  
- Disclosure of internal feature names, endpoints, and challenge hints that aid automated or human attackers.  
- Low-friction reconnaissance enabling automated scanning or targeted attacks.  
- Can reveal content that facilitates credential guessing, privilege escalation, or logic abuse.

**Mitigations**  
- Remove non-production localization and debug artifacts from production builds.  
- Restrict access to internal resources by authentication and environment checks.  
- Treat localization bundles as code/artifacts — build them per-deployment and exclude hidden or challenge-related content.
- Sanitize strings to avoid embedding secrets, endpoints, or implementation hints.

---

## Detection and Logging Recommendations

- Monitor requests for non-standard locale codes and alert on access to localization files not expected in production.  
- Log high-volume or automated requests to static asset endpoints and apply anomaly detection.  
- Integrate artifact-scanning into CI to detect and prevent shipping debug/localization files with sensitive strings.

---

## Hardening Checklist

- Exclude debug, test, and challenge-specific assets from production releases.  
- Enforce authentication/authorization for access to internal or admin assets.  
- Apply rate-limiting, CAPTCHAs, or bot-detection on endpoints prone to automated enumeration.  
- Use a deny-by-default approach for static asset serving; only expose whitelisted assets.  
- Regularly scan deployed assets for unexpected files or locales and remediate immediately.  

---
```
