# Sensitive Data Exposure

**Category overview**  
Sensitive Data Exposure occurs when applications fail to adequately protect confidential information at rest, in transit, or in logs. Examples include exposed backups, plaintext secrets, weakly protected credentials, verbose error messages leaking structure, and insecure storage of personal data. Exploitation can lead to credential theft, account compromise, regulatory violations, and accelerated reconnaissance for further attacks.

---

## Overview Observed in This Assessment

The following sensitive-data issues were discovered and validated in a controlled Juice Shop lab:

- **Forgotten Developer Backup** — exposed `.bak` file retrievable via null-byte injection.  
- **Forgotten Sales Backup** — sales/DB backups available under `/ftp` without authorization.  
- **Björn’s Favorite Pet** — public OSINT information allowed password-reset abuse.  
- **Login Amy** — weak user credentials discovered through exposed hints and reuse.  
- **Misplaced Signature File** — internal server configuration file accessible via web route.

Each finding below includes concise Steps to Reproduce, Impact, and Mitigations.

---

### A Forgotten Developer Backup

**What it is**  
Backup or developer files left in web-accessible locations that contain code, credentials, or configuration.

**Observed in lab**  
A backup file such as `package.json.bak%2500.md` was downloadable from the app using a null-byte or filename truncation technique, revealing package metadata and potential secrets.

**Steps to Reproduce (concise)**  
1. Identify candidate backup filenames (e.g., `package.json.bak`).  
2. Request the file directly or use a null-byte-encoded name (`%2500`) to bypass filters.  
3. Download and inspect for credentials, endpoints, or scripts.

**Impact**  
- Exposure of API keys, DB connection strings, and internal scripts.  
- Facilitates remote code execution and targeted attacks.  
- Compromises confidentiality of developer and system data.

**Mitigations**  
- Remove backups from web roots and ensure deployments exclude development artifacts.  
- Enforce secure CI/CD packaging that omits sensitive files.  
- Encrypt backups and store them in access-controlled locations not reachable via the web server.

---

### B Forgotten Sales Backup

**What it is**  
Production or data backups stored in predictable, publicly reachable directories without authentication.

**Observed in lab**  
Sales or database backup files were accessible under `/ftp` or similar directories and could be downloaded without credentials.

**Steps to Reproduce (concise)**  
1. Enumerate common backup paths (`/ftp`, `/backup`, `/files`).  
2. Attempt to access likely backup filenames via browser or curl.  
3. Download and inspect for PII, schema, or credentials.

**Impact**  
- Leakage of customer data, order records, and personally identifiable information.  
- Regulatory risk and reputational damage.  
- Enables SQLi/logic attacks by revealing schema and data patterns.

**Mitigations**  
- Move backups off public web storage and restrict to authenticated admin-only locations.  
- Encrypt backups at rest and in transit; rotate keys regularly.  
- Implement least-privilege access controls and monitor backup downloads.

---

### C Björn’s Favorite Pet

**What it is**  
Use of public, discoverable personal information as part of authentication or recovery mechanisms (OSINT-vulnerable secrets).

**Observed in lab**  
A password-reset question referenced information available in public profiles or content, allowing the attacker to supply the correct answer and reset the account.

**Steps to Reproduce (concise)**  
1. Gather OSINT about the target (social posts, profiles, public comments).  
2. Use the discovered value as the answer to the security question in the reset flow.  
3. Complete reset and set a new password.

**Impact**  
- Account takeover and unauthorized access to user data.  
- Amplified risk if users reuse passwords across services.

**Mitigations**  
- Replace knowledge-based recovery with single-use, time-limited email/SMS tokens.  
- Avoid using public or easily discoverable facts as authentication secrets.  
- Encourage MFA and monitor recovery attempts for anomalous behavior.

---

### D Login Amy

**What it is**  
Exposure of weak or reused credentials through hints, insecure storage, or insufficient protection of authentication data.

**Observed in lab**  
Hints combined with weak password patterns allowed discovery of Amy’s credentials; credential reuse risk was present.

**Steps to Reproduce (concise)**  
1. Collect any in-app hints or public clues about password composition.  
2. Attempt credential guesses or automated brute-force against the login endpoint.  
3. Confirm successful login and access protected resources.

**Impact**  
- Unauthorized access to the user account and associated data.  
- If reused elsewhere, broader compromise across systems.

**Mitigations**  
- Enforce strong password policies and prohibit common or patterned passwords.  
- Implement MFA, password leak detection, and monitoring for credential stuffing.  
- Hash passwords with modern algorithms (bcrypt, Argon2) and never store plaintext.

---

### E Misplaced Signature File

**What it is**  
Internal configuration, signing keys, or signature files exposed via web directories or misconfigured endpoints.

**Observed in lab**  
A YAML signature/config file intended for internal services was accessible and contained secrets and configuration metadata.

**Steps to Reproduce (concise)**  
1. Enumerate likely internal filenames and paths.  
2. Request files directly and inspect returned contents.  
3. Use discovered keys or endpoints for further reconnaissance or forging attempts.

**Impact**  
- Disclosure of signing keys or service credentials enabling token forgery or lateral movement.  
- Rapid escalation of further attacks and loss of trust boundaries.

**Mitigations**  
- Store secrets in secure vaults, not in repository or web-accessible files.  
- Apply strict file-serving rules and require authentication for internal resources.  
- Rotate any keys found exposed and audit all systems that used them.

---

## Detection and Logging Recommendations

- Monitor and alert on requests for known backup filenames and high-volume downloads from file-serving endpoints.  
- Scan deployed assets for common backup extensions and internal config files as part of CI/CD.  
- Log and review password-reset and recovery activity with geolocation/IP anomalies.  
- Integrate automated secret scanning into repositories and deployment artifacts.

---

## Hardening Checklist

- Exclude development and backup artifacts from production builds.  
- Use encrypted, access-controlled storage for backups and internal files.  
- Replace knowledge-based recovery with token-based flows and enforce MFA.  
- Hash and salt passwords with strong algorithms and monitor for credential reuse.  
- Implement automated scans for exposed files and secret detection in CI pipelines.  
- Maintain an inventory of internal endpoints and files for targeted monitoring.

---

